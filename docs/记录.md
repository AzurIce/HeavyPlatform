# 记录

由于项目的搭建过程中，会一点点地引入很多技术。

为了避免类似「这一大坨东西是怎么来的？？？」的情况，我会把搭建整个项目的过程简要记录一下。

## 一、Solid 项目创建

> 对应变动：[00fd805..82fa81f](https://github.com/AzurIce/HeavyPlatform/compare/00fd805...82fa81f)

没什么好说的：https://docs.solidjs.com/quick-start#for-typescript-projects

### 1. 入口

`index.html` 是一切的起点，vite 的大包也是“顺着” `index.html` 去“捋”出来一个个依赖，再构建在一起。

`index.html` 中有下面两个关键的东西：

```html
<div id="root"></div>

<script src="/src/index.tsx" type="module"></script>
```

- `id` 为 `root` 的 `div` 标签（会用于后续渲染）
- 加载 `/src/index.tsx` 的 `script` 标签

`src/index.tsx` 中则是对 Solid API 的调用：

```tsx
/* @refresh reload */
import { render } from 'solid-js/web';

import './index.css';
import App from './App';

const root = document.getElementById('root');

if (import.meta.env.DEV && !(root instanceof HTMLElement)) {
  throw new Error(
    'Root element not found. Did you forget to add it to your index.html? Or maybe the id attribute got misspelled?',
  );
}

render(() => <App />, root!); // 将 App 组件绘制到 root 元素中

```

> `root!` 是 ts 中对变量非空的断言。

### 2. 组件 与 jsx/tsx

将 HTML 标签作为一种 js/ts 值（被称作 JSX 元素）与 js/ts 混写的语法叫做 jsx/tsx，是对 js/ts 的愈发扩展。

在使用 jsx/tsx 的框架中，一个「组件」的概念很简单 —— 就是一个会返回 JSX 元素的函数。

Solid 中对 Component 类型的定义如下：

```ts
type Component<P = {}> = (props: P) => JSX.Element
```

## 二、引入 Solid Router

> 对应变动：[afbc691...a67045a](https://github.com/AzurIce/HeavyPlatform/compare/afbc691...a67045a)

如果你用过 Vue Router 或者 React Router，那么类似，Solid Router 也是用于完成相关工作的。

```
pnpm i @solidjs/router
```

调整目录结构：

- `/src`

    - 【+】`components`：存放组件

        如果是单文件，那就直接是 `<ComponentName>.tsx`

        如果有多个文件，那就放在 `<ComponentName>/` 目录下，并且用于导出的 `tsx` 命名为 `index.tsx`

        > 这是为了统一 import 时的路径，都是 `components/<ComponentName>`

    - 【+】`pages`：存放页面（对应路由）

对应的，将 `App` 中现有的内容抽离为了一个 `Hello` 组件，并新增了一个简单的 `NotFound` 页面，和一个显示 `Hello` 组件的 `Main` 页面。

然后在 `App` 中使用 Solid Router 的 `Router` 和 `Route` 来定义路由：

```tsx
import type { Component } from 'solid-js';
import { Router, Route } from "@solidjs/router";

import Main from './pages/Main';
import NotFound from './pages/NotFound';

const App: Component = () => {
  return <>
    <Router>
      <Route path="/" component={Main}/>
      <Route path="*404" component={NotFound}/>
    </Router>
  </>;
};

export default App;

```

现在访问 `/` 路径则会显示原来的内容，而其他没有被匹配到的路径则会落入 `*404` 中，显示 `NotFound` 组件。

## 三、引入 UnoCSS

// TODO